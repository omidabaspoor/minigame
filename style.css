/* --- General Styles & Dark Theme --- */
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Vazirmatn', sans-serif; background-color: #1a1a1a; color: #e0e0e0; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; touch-action: none; }
#game-container { display: flex; flex-direction: column; align-items: center; gap: 15px; padding: 2.5vw; background-color: #2c2c2c; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); width: 95vw; max-width: 450px; height: 90vh; max-height: 800px; }

/* --- Header Info --- */
#game-info { display: flex; justify-content: space-around; width: 100%; z-index: 10; }
.info-box { background-color: rgba(26, 26, 26, 0.7); backdrop-filter: blur(4px); padding: 10px 20px; border-radius: 10px; text-align: center; min-width: 120px; border: 1px solid rgba(255, 255, 255, 0.1); }
.info-box h2 { font-size: 0.9rem; font-weight: 400; color: #aaa; }
.info-box p { font-size: 1.8rem; font-weight: 700; }

/* --- Game Area & Backgrounds --- */
#game-area { width: 100%; height: 100%; background-color: #1f1f1f; border-radius: 10px; position: relative; overflow: hidden; cursor: none; }
#background-blur { position: absolute; width: 120%; height: 120%; top: -10%; left: -10%; background-image: url('data:image/jpeg;base64,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');
    filter: blur(10px);
    z-index: 0;
}
#particles-bg { position: absolute; width: 100%; height: 100%; background-image: radial-gradient(#666 1px, transparent 1px); background-size: 30px 30px; animation: move-bg 20s linear infinite; z-index: 1; opacity: 0.3; }
@keyframes move-bg { from { background-position: 0 0; } to { background-position: -600px 0; } }

/* --- Player & Items --- */
#player-cup { width: 85px; height: 65px; background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 70"%3E%3Cdefs%3E%3ClinearGradient id="cup-grad" x1="0" y1="0" x2="0" y2="1"%3E%3Cstop offset="0%" stop-color="%23f0f0f0"/%3E%3Cstop offset="100%" stop-color="%23c0c0c0"/%3E%3C/linearGradient%3E%3Cfilter id="glow"%3E%3CfeGaussianBlur stdDeviation="2.5" result="coloredBlur"/%3E%3CfeMerge%3E%3CfeMergeNode in="coloredBlur"/%3E%3CfeMergeNode in="SourceGraphic"/%3E%3C/feMerge%3E%3C/filter%3E%3C/defs%3E%3Cpath d="M10 10 H90 V50 C90 60, 80 70, 70 70 H30 C20 70, 10 60, 10 50 V10 Z" fill="url(%23cup-grad)" stroke="%23fff" stroke-width="2"/%3E%3Cpath d="M90 20 H98 C102 20, 102 40, 98 40 H90" fill="none" stroke="url(%23cup-grad)" stroke-width="5"/%3E%3C/svg%3E'); background-size: contain; background-repeat: no-repeat; background-position: center; position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); transition: left 0.05s linear; z-index: 5; }
.falling-item { position: absolute; width: 48px; height: 48px; background-size: contain; background-repeat: no-repeat; background-position: center; animation: fall linear forwards; z-index: 2; will-change: transform; }
@keyframes fall { from { transform: translateY(-50px) rotate(0deg); } to { transform: translateY(100vh) rotate(180deg); } }

/* --- NEW GRAPHICAL ICONS --- */
.item-coffee { background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"%3E%3Cdefs%3E%3CradialGradient id="a" cx="32" cy="32" r="32" gradientUnits="userSpaceOnUse"%3E%3Cstop offset=".5" stop-color="%23a67c52"/%3E%3Cstop offset="1" stop-color="%236f4e37"/%3E%3C/radialGradient%3E%3C/defs%3E%3Celliptse cx="32" cy="32" rx="20" ry="30" fill="url(%23a)"/%3E%3Cpath d="M32 2a2 2 0 0 0-2 2v56c0 1.1.9 2 2 2s2-.9 2-2V4c0-1.1-.9-2-2-2z" fill="%234a3424" opacity=".7"/%3E%3Cpath d="M36 12c-8 20-8 30 0 40-10-10-10-30 0-40z" fill="rgba(255,255,255,.2)"/%3E%3C/svg%3E'); }
.item-latte { background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"%3E%3Cdefs%3E%3Cfilter id="c"%3E%3CfeGaussianBlur stdDeviation=".5"/%3E%3C/filter%3E%3C/defs%3E%3Ccircle cx="32" cy="32" r="30" fill="%236f4e37"/%3E%3Ccircle cx="32" cy="32" r="28" fill="%23c6a686"/%3E%3Cpath d="M32 16c-12 5-15 15-10 25 5 10 20 12 25 5s0-20-15-30zm5 15c-5 5-15 5-20-5 5-10 15-10 20 5z" fill="%23fff" filter="url(%23c)"/%3E%3C/svg%3E'); }
.item-bad-bean { background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"%3E%3Cdefs%3E%3CradialGradient id="d" cx="32" cy="32" r="32" gradientUnits="userSpaceOnUse"%3E%3Cstop offset=".5" stop-color="%23555"/%3E%3Cstop offset="1" stop-color="%23222"/%3E%3C/radialGradient%3E%3C/defs%3E%3Celliptse cx="32" cy="32" rx="20" ry="30" fill="url(%23d)"/%3E%3Cpath d="M32 2a2 2 0 0 0-2 2v56c0 1.1.9 2 2 2s2-.9 2-2V4c0-1.1-.9-2-2-2z" fill="%23111" opacity=".7"/%3E%3Cpath d="M25 45l5-5 5 5-3-6 3-6-5 5-5-5 3 6z" fill="%23000"/%3E%3C/svg%3E'); animation: fall linear forwards, bad-glow 1s infinite alternate; }
.item-bad-cup { background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"%3E%3Cpath d="M10 10 H54 V42 C54 52 48 62 38 62 H26 C16 62 10 52 10 42Z" fill="%23999"/%3E%3Cpath d="M20 20l24 24M44 20L20 44" stroke="%23222" stroke-width="4"/%3E%3C/svg%3E'); animation: fall linear forwards, bad-glow 1s infinite alternate; }
.item-powerup { background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"%3E%3Cdefs%3E%3ClinearGradient id="e" x1="0" y1="0" x2="1" y2="1"%3E%3Cstop offset="0%" stop-color="%23fff"/%3E%3Cstop offset="100%" stop-color="%2387ceeb"/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath d="M32 2 L12 12 V32 L32 62 L52 32 V12Z" fill="url(%23e)"/%3E%3Cpath d="M32 12 v20 l10 10" stroke="%231a1a1a" stroke-width="4" stroke-linecap="round" fill="none"/%3E%3C/svg%3E'); animation: fall linear forwards, powerup-glow 1.5s infinite alternate; }
@keyframes bad-glow { from { filter: drop-shadow(0 0 5px red); } to { filter: drop-shadow(0 0 15px red); } }
@keyframes powerup-glow { from { filter: drop-shadow(0 0 5px #87ceeb); } to { filter: drop-shadow(0 0 15px #87ceeb); } }

/* --- Floating Score Effect & Shake --- */
.floating-score { position: fixed; font-size: 1.8rem; font-weight: bold; opacity: 0; animation: float-up 1.5s ease-out forwards; pointer-events: none; z-index: 100; text-shadow: 0 0 5px black; }
.score-good { color: #4dff88; } .score-bad { color: #ff4d4d; } .score-powerup { color: #87ceeb; }
@keyframes float-up { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-80px); opacity: 0; } }
.shake { animation: screen-shake 0.3s; }
@keyframes screen-shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } }

/* --- Modal --- */
#modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px); display: flex; justify-content: center; align-items: center; z-index: 100; padding: 20px; transition: opacity 0.3s, visibility 0.3s; visibility: hidden; opacity: 0; }
#modal.visible { visibility: visible; opacity: 1; }
.modal-content { background: #2c2c2c; padding: 30px 40px; border-radius: 20px; text-align: center; box-shadow: 0 0 20px rgba(228, 179, 99, 0.4); border: 2px solid #e4b363; width: 100%; max-width: 400px; }
#modal-title { color: #e4b363; font-size: 1.8rem; margin-bottom: 15px; }
#modal-message { font-size: 1.1rem; margin-bottom: 20px; line-height: 1.6; }
#discount-container { background: #1a1a1a; border-radius: 10px; padding: 15px; margin: 20px 0; }
#discount-container.hidden { display: none; }
#discount-title { margin-bottom: 10px; color: #aaa; font-size: 0.9rem; }
#discount-code { font-size: 1.5rem; font-weight: 700; letter-spacing: 2px; }
#start-btn { font-family: 'Vazirmatn', sans-serif; background-color: #e4b363; color: #1a1a1a; border: none; padding: 12px 30px; font-size: 1.1rem; font-weight: 700; border-radius: 10px; cursor: pointer; transition: transform 0.2s; }
#start-btn:hover { transform: scale(1.05); }
#discount-code.tier-gold { color: #ffd700; text-shadow: 0 0 8px #ffd700; }
#discount-code.tier-silver { color: #c0c0c0; text-shadow: 0 0 8px #c0c0c0; }
#discount-code.tier-bronze { color: #cd7f32; text-shadow: 0 0 8px #cd7f32; }